# 隠れマルコフモデル

---

### 隠れマルコフモデル
* 学習済みのHMMを使えば確率モデルを近似できる
* HMM自体に学習する機能はない(HMMはただのモデル) 
* 別のアルゴリズムを使って学習させる必要がある
* 入力系列の長さがバラバラでも簡単に導入できる

---

### 単純マルコフモデルの例
<img src="./image/HMM/simple_hmm.png" width="500"></img>
### 単純マルコフモデル

---

### HMMと普通のマルコフの違い
* 単純マルコフはすべての状態を観測できた
* 対してHMMは観測できない状態(潜在変数の状態)を持っている
* しかしその出力は観測する事ができる

---

### 記号の準備
* $ x\_t \in \\{ v\_1,v\_2,\dots ,v\_m \\}$　:　時刻$t$での観測結果
* $\boldsymbol{X} = x_1 x_2 \dots x_n$　:　入力系列
* $ s\_t \in \\{ \omega\_1,\omega\_2,\dots ,\omega\_c \\}$　:　時刻$t$での状態
* $\boldsymbol{S} = s_1 s_2 \dots s_n$　:　状態系列 (HMMではこれは観測出来ない)
* $a_{ij}$　:　$w_i$から$w_j$への状態遷移確率
* $\boldsymbol{A}$　:　$a_{ij}$の集合　
* $b_{jk}$　:　$w_j$で$v_k$を出力する確率
* $\boldsymbol{B}$　:　$b_{ij}$の集合
* $\rho_i$　:　初期状態が$\omega_i$である確率
* $\boldsymbol{\rho}$　:　$\\{\rho\_1,\rho\_2,\dots,\rho\_c\\}$

---

<img src="./image/HMM/HMM_origin.png" width="500"></img>
### 隠れマルコフモデル

---

### 具体例(wikiより)
* アリスとボブは遠距離で連絡を取り合っている
* ボブ
    * 毎日天気(潜在変数)を参考にwalk,shop,cleanのどれかの行動を取る
    * 毎日どの行動をとったかをアリスに報告する(実際の天気については教えない)
* アリス
    * ボブから連絡を受け，どの行動をとったかを知る()
    * 一般的な天気の変化の情報は持っている(潜在変数の状態遷移確率を知っている)

これをHMMとしてモデル化してみる

---

<img src="./image/HMM/HMM.png" width="500"></img>
### HMMの例

赤矢印と青矢印はアリスによる推測結果

---

### 疑問点
* パラメータの決め方
    * 実際は潜在変数の状態遷移確率も分からない
    * アリスが推測した部分はどうやって学習させればいいか？
* 各クラスである確率は具体的にどうやって求めるのか？
* 具体的にどうやってHMMを分類問題に使うのか

---


### ちなみにHMMにも種類がある
* Ergodic HMM(アリスとボブの例)
    * 前の状態に戻れる
* **left to right HMM**
    * 前の状態に戻れない

---

<img src="./image/HMM/LR_HMM.jpg" width="500"></img>
### left to right HMM

---

### 分類問題におけるHMM

---

### 分類問題におけるHMM
* HMMによる分類はソフトクラスタリングというジャンル
* 各クラスに属している確率を推定する事が目標(EMアルゴリズムと同じ)
* つまり$n$クラス問題を特には$n$個のHMMを学習させる必要がある

---

### 記号の準備
* $ x\_t \in \\{ v\_1,v\_2,\dots ,v\_m \\}$　:　時刻$t$での観測結果
* $\boldsymbol{X} = x_1 x_2 \dots x_n$　:　入力系列
* $ s\_t \in \\{ \omega\_1,\omega\_2,\dots ,\omega\_c \\}$　:　時刻$t$での状態
* $\boldsymbol{S} = s_1 s_2 \dots s_n$　:　状態系列 (HMMではこれは観測出来ない)
* $a_{ij}$　:　$w_i$から$w_j$への状態遷移確率
* $\boldsymbol{A}$　:　$a_{ij}$の集合　
* $b_{jk}$　:　$w_j$で$v_k$を出力する確率
* $\boldsymbol{B}$　:　$b_{ij}$の集合
* $\rho_i$　:　初期状態が$\omega_i$である確率
* $\boldsymbol{\rho}$　:　$\\{\rho\_1,\rho\_2,\dots,\rho\_c\\}$

---

目標は入力系列が得られる確率，

つまり分類問題の場合，そのクラスに分類される確率$P\(x\)$を求める事．

---